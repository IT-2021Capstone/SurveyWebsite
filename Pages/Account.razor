@page "/Account"
@using SurveyWebsite.Data
@using SurveyWebsite.Pages
@using System.Security.Claims
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor _httpContextAccessor
@inject Testingstuff ts
@inherits OwningComponentBase<Testingstuff>
@inject NavigationManager NavMngr

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SurveyWebsite</title>
    <base href="~/" />
    <link rel="stylesheet" href="css/bootstrap/bootstrap.min.css" />
    <link href="css/site.css" rel="stylesheet" />
    <link href="css/Account.css" rel="stylesheet" />
    <link href="SurveyWebsite.styles.css" rel="stylesheet" />
</head>
<body>
    <h1>Account Page</h1>
    <hr />
    <div class="row" id="profilesidebar">
        <div>
            @*<img src="" alt="profile" id="profilepic">*@
            <h5>Role: </h5>
        </div>
    </div>
    <div class="row">
        <div class="flex-column">
            <div class="card-deck">
                <div class="card mb-4">
                    <div class="card-block">
                        <h4 class="card-title">Survey's Taken</h4>
                        <p class="card-text">
                            Click this Button to see the Survey's you have taken.<br />
                            <button class="btn btn-primary" @onclick="TakenRedirect"> Survey's Taken </button>
                        </p>
                        <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                    </div>
                </div>
                <span></span>
                <div class="card mb-4">
                    <div class="card-block">
                        <h4 class="card-title">Survey's Created</h4>
                        <p class="card-text">
                            Click this Button to see your Created Survey's.<br />
                            <button class="btn btn-primary" @onclick="CreatedRedirect"> Survey's Created </button>
                        </p>
                        <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                    </div>
                </div>
                <span></span>
                <div class="card mb-4">
                    <div class="card-block">
                        <h4 class="card-title">Survey's Created</h4>
                        <p class="card-text">
                            Click this Button to see the Order of the Surveys currently on the site.<br />
                            <button class="btn btn-primary" @onclick="ViewOrder"> Order of Surveys </button>
                        </p>
                        <p class="card-text"><small class="text-muted">Last updated 3 mins ago</small></p>
                    </div>
                </div>
                <span></span>
            </div>
        </div>
    </div>
</body>
</html>




@code {

    private string user = "";

    protected override void OnInitialized()
    {
        if (_httpContextAccessor.HttpContext.User.Identity.IsAuthenticated)
        {

            user = _httpContextAccessor.HttpContext.User.FindFirst(ClaimTypes.NameIdentifier).Value;
        }


        base.OnInitialized();
    }

    private void TakenRedirect()
    {
        NavMngr.NavigateTo("/SurveysTaken");
    }

    private void CreatedRedirect()
    {
        //var m = ts.ViewCreated(user);
        NavMngr.NavigateTo("/SurveysMade");
    }

    //public string[] ViewTaken()
    //{
    //    var n = ts.ViewTaken(user);
    //}

    private void ViewOrder()
    {
        NavMngr.NavigateTo("/OrderList");
    }
}